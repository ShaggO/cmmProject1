%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Journal Article
% LaTeX Template
% Version 1.3 (9/9/13)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Frits Wenneker (http://www.howtotex.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[twoside]{article}

\usepackage{lipsum} % Package to generate dummy text throughout this template

\usepackage[sc]{mathpazo} % Use the Palatino font
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\linespread{1.05} % Line spacing - Palatino needs more space between lines
\usepackage{microtype} % Slightly tweak font spacing for aesthetics

\usepackage[hmarginratio=1:1,top=32mm,columnsep=20pt]{geometry} % Document margins
\usepackage{multicol} % Used for the two-column layout of the document
\usepackage[hang, small,labelfont=bf,up,textfont=it,up]{caption} % Custom captions under/above floats in tables or figures
\usepackage{booktabs} % Horizontal rules in tables
\usepackage{float} % Required for tables and figures in the multi-column environment - they need to be placed in specific locations with the [H] (e.g. \begin{table}[H])
\usepackage[hidelinks]{hyperref} % For hyperlinks in the PDF

\usepackage{lettrine} % The lettrine is the first enlarged letter at the beginning of the text
\usepackage{paralist} % Used for the compactitem environment which makes bullet points with less space between them

\usepackage{todonotes}
\usepackage{amsmath,amssymb,amsfonts}
\providecommand{\abs}[1]{\left \lvert #1 \right \rvert}

\usepackage{abstract} % Allows abstract customization
\renewcommand{\abstractnamefont}{\normalfont\bfseries} % Set the "Abstract" text to bold
\renewcommand{\abstracttextfont}{\normalfont\small\itshape} % Set the abstract itself to small italic text

\usepackage{titlesec} % Allows customization of titles
\renewcommand\thesection{\Roman{section}} % Roman numerals for the sections
\renewcommand\thesubsection{\Roman{subsection}} % Roman numerals for subsections
\titleformat{\section}[block]{\large\scshape\centering}{\thesection.}{1em}{} % Change the look of the section titles
\titleformat{\subsection}[block]{\large}{\thesubsection.}{1em}{} % Change the look of the section titles

\usepackage{fancyhdr} % Headers and footers
\pagestyle{fancy} % All pages have headers and footers
\fancyhead{} % Blank out the default header
\fancyfoot{} % Blank out the default footer
%\fancyhead[C]{Running title $\bullet$ November 2012 $\bullet$ Vol. XXI, No. 1} % Custom header text
\fancyfoot[RO,LE]{\thepage} % Custom footer text

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\title{\vspace{-15mm}\fontsize{24pt}{10pt}\selectfont\textbf{Local Adaptive
Optimization of Time Step}} % Article title

\author{
\large
\textsc{Malte St√¶r Nissen}\thanks{Thank to my supervisor Sune Darkner for
helping me realize this project}\\[2mm] % Your name
\normalsize University of Copenhagen \\ % Your institution
\normalsize \href{mailto:nissen@diku.dk}{nissen@diku.dk} % Your email address
\vspace{-5mm}
}
\date{}

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle % Insert title

\thispagestyle{fancy} % All pages have headers and footers

%----------------------------------------------------------------------------------------
%	ABSTRACT
%----------------------------------------------------------------------------------------

\begin{abstract}


\end{abstract}

%----------------------------------------------------------------------------------------
%	ARTICLE CONTENTS
%----------------------------------------------------------------------------------------

\begin{multicols}{2} % Two-column layout throughout the main article text

\section{Introduction}
\lettrine[nindent=0em,lines=3]{S} imulations of large hyper elastic materials
can be very time consuming. When working with materials of varying density
of vertices/scale of mesh, the highest densities often make the most
strict bounds on size of the time step of the simulation in order to keep
the materials (and grids) stable and the discretization correct. in a
``standard'' simulation with a global time step size we need to compute
possibly unnecessarily many computations on the coarser parts of the material
caused by this bound. When furthermore having materials with a large amount
of somewhat equally distributed vertices and smaller patches of detailed
areas with higher density of vertices, it would be an advantage to be able
to perform large time steps for the majority of the material (the coarse
parts) and smaller steps for the local patches where vertices could cause
instability. we call the concept of varying the timestep local adaptive
optimization of time step (LAOTS), in which ``local'' either refers to spatial
locality (as described above) or time locality where the time step is global
for all vertices but varies during the simulation. We will in this report
study possible approaches for application of LAOTS. In order to keep the focus
on possible LAOTS methods and remove unneccessary complexities we will study
the simple 1 dimensional simulation of a mass spring system and try to apply
LAOTS for it. Afterwards we will shortly discuss the application of our gained
knowledge to the domain of hyper elastic material simulation and simulations
in general.

%------------------------------------------------

\section{Previous work}
As according to \cite{Gander:2013} local time stepping was first studied
in the community of ordinary differential equations (ODE) with Rice
\cite{rice:1960} developing the split Runge-Kutta methods (multi rate
Runge-Kutta methods). The concept behind these methods is the splitting of
the ODEs into multiple (two components in \cite{rice:1960}) components of
which each component needs to be integrated in different scales. A strategy
is chosen as proposed in \cite{Kvaernoe:1999} of either computing the coarser
part first (``Fastest first strategy'') followed by the finer part or vice
versa (``Slowest first strategy''). In order to perform these sequential
computations either interpolation or extrapolation of the first computation
is performed to compute the second part in each time step and the different
time step sizes can be adapted to fit the model in each step as well. See
\cite{Kvaernoe:1999} and \cite{Gear:1984} (similar strategy for linear multi
step methods) for more detailed descriptions of the two strategies.

In the partial differential equations (PDE) community, the adaptive time
stepping area was explored and developed with the goal of simulating
very specific known problems such as the (hyperbolic) wave equations
and (parabolic) heat equations instead of more general applications. We
will adhere from describing the methods further in this report, but a
short description and comparison of the specific methods can be found in
\cite{Gander:2013}. Generally the methods developed at first all make use
of the same basic concepts for making the local adaptive time stepping:
Interpolation, extrapolation, prediction and correction, which we are going to
use in the work of this report as well.

Recently newer and faster methods with local time stepping have been developed
on the basis of nonlinear PDEs and the work performed in this field in
the 80s and 90s. First the multi resolution (MR) schemes for creating
space-adaptive discretizations and refinements of these were developed, see
\cite{Berger:1984}. Then multiple MR based schemes were developed. Domingues
et al. \cite{Domingues:2008} is one of the more recent of these MR schemes.
They describe a local scale-dependent time stepping for a space-adaptive multi
resolution scheme using the finite volume method in order to obtain speed-up
using larger time-steps without violating a defined stability constraints,
which is essentially the same motivation as this report. The method is based
on an explicit Runge-Kutta method of second order. As expected the time step
size is imposed by a stability condition of the explicit Runge-Kutta on the
finest scale, which increases with the scale of the mesh and hence we are able
to increase the time step as well without violating the stability condition.


%------------------------------------------------

\section{Methods}

With no prerequisites within the field of mass simulations we will first
consider the 1D problem of simulating a mass spring system using the explicit
(forward) Euler method.

Second we will propose and test out three different methods for applying LAOTS
to the simulation.

Third and last we will discussion the results and how we
could apply our knowledge of LAOTS for hyper elastic material.

\subsection{1D mass spring system}
Mass spring systems are systems simulating a set of vertices interconnected by
springs in various ways to obtain desirable physical properties. The motion of
the springs and vertices are then simulated as a function of the time elapsed.
Examples of application of mass spring systems are for simulation of cloth or
hair.

Our mass spring system consists of a set $V$ of vertices and a set $S$ of
springs. Each vertex $v \in V$ has a specified position $p_v$, mass $m_v$, force
$F_v$
and velocity $u_v$ and each spring $s$ has two endpoints vertices $p_{sf} \in V$
and $p_{st} \in V \setminus p_{sf}$, a damping factor $d_s$, a stiffness
constant $K_s$ and a rest length $l_{s0}$. Combined all these variables and
constants describe the state of the mass spring system at each timestep during a
simulation.

As each vertex $v$ is connected to 1 or 2 springs, its motion can be calculated by
the total force $F_v$ applied by the springs it is connected to. The spring
force is calculated using Hooke's Law and adding damping [TODO: Add reference (wiki):
    \url{http://en.wikipedia.org/wiki/Harmonic_oscillator}]:
\begin{align}
    \label{eq:hooke}
    F_{h,d} &= -k_d x_d = -k_d (l_d - l_{0,d}) \\
    \label{eq:damping}
    F_{C,d} &= -C_d \frac{dx_d}{dt} = - C_d \frac{\left(v_{left} - v_{right}\right)
\Delta l}{\abs{\Delta l}}
\end{align}
in which $F_h$ is the spring force of Hooke's Law, $F_c$ is the damping force,
$k$ is the spring constant, $x$ is the difference between the current length of
the spring and the spring rest length, $c$ is the damping constant and
$\frac{dx}{dt}$ is the velocity of the vertex $v$.

Things to write about (notes):

Damping force $F_d$:
\begin{align}
    \Delta l &= l_{left} - l_{right} \\
    F_d      &= - C_d v(i) =  - C_d \frac{\left(v_{left} - v_{right}\right)
\Delta l}{\abs{\Delta l}}
\end{align}

Spring force $F_s$:
\begin{align}
    F_s = -kx = -k \left( l - l_0 \right)
\end{align}

Explicit Euler method:
\begin{align}
    x(t+h) &= x(t) + h \frac{\partial x(t)}{\partial t}
\end{align}

Midpoint method:
\begin{align}
    x(t+h) = x(t) + h \left( f \left(x + \frac{h}{2} f \left(t \right) \right) \right)
\end{align}

\cite{Keshav:2007}
\subsection{Switch}
Change timestep when detecting collision/switch in next iteration

\subsection{Spatial LAOTS}
Atomic update

Fixed update rate and detection of need for re-calculation of individual springs

Heuristic: Length of spring, steps since last update

\subsection{Inverse}
Time-local optimization according to heuristic:

\begin{align}
    \frac{1}{a} &= \frac{1}{\frac{-kx}{m}} = \frac{m}{-kx} \\
    \Delta t &= \abs{\frac{1}{a}} + \frac{1}{0.1}
\end{align}

%------------------------------------------------

\section{Results}

%\begin{table}[H]
%\caption{Example table}
%\centering
%\begin{tabular}{llr}
%\toprule
%\multicolumn{2}{c}{Name} \\
%\cmidrule(r){1-2}
%First name & Last Name & Grade \\
%\midrule
%John & Doe & $7.5$ \\
%Richard & Miles & $2$ \\
%\bottomrule
%\end{tabular}
%\end{table}

%------------------------------------------------

\section{Discussion}

Adaptive timestepping based on highest acceleration/smallest grid

%----------------------------------------------------------------------------------------
%	REFERENCE LIST
%----------------------------------------------------------------------------------------

\bibliography{bibliography}
\bibliographystyle{plain}

%----------------------------------------------------------------------------------------

\end{multicols}

\end{document}
